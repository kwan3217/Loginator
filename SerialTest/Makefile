#Since the whole point of this project is to test the LPC4078, set the submodel here
SUBMDL=LPC4078
OPTLEVEL = 3
PROJECT_BRIEF="Serial port test, mostly only useful for LPC4078"
HWDESCCSV=Loginator2368Hardware.csv Loginator2368Onboard.csv
#include ../libraries/LPCduino/Makefile
include ../libraries/peripherals/Serial/Makefile
#include ../libraries/dump/Makefile
#include ../libraries/hardwareDesc/Makefile
include ../libraries/System/Makefile
ARM_SYMBOLS+=--add-symbol '$$d=.arm:0x000,local'
ARM_SYMBOLS+=--add-symbol '$$t=.arm:0x01c,local'
ARM_SYMBOLS+=--add-symbol '$$d=.arm:0x030,local'
ARM_SYMBOLS+=--add-symbol '&reset_cont=.arm:0x030'
ARM_SYMBOLS+=--add-symbol '~bit14=.arm:0x034'
ARM_SYMBOLS+=--add-symbol '&sysctl[3c0]=.arm:0x038'
ARM_SYMBOLS+=--add-symbol '$$t=.arm:0x03C,local'
ARM_SYMBOLS+=--add-symbol 'reset_cont=.arm:0x03C'
ARM_SYMBOLS+=--add-symbol '$$d=.arm:0x0b0,local'
ARM_SYMBOLS+=--add-symbol '$$t=.arm:0x0e0,local'
ARM_SYMBOLS+=--add-symbol '&stack=.arm:0x000'
ARM_SYMBOLS+=--add-symbol '&reset=.arm:0x004'
ARM_SYMBOLS+=--add-symbol '&nmi=.arm:0x008'
ARM_SYMBOLS+=--add-symbol '&hardfault=.arm:0x00C'
ARM_SYMBOLS+=--add-symbol '&mmfault=.arm:0x010'
ARM_SYMBOLS+=--add-symbol '&busfault=.arm:0x014'
ARM_SYMBOLS+=--add-symbol '&usagefault=.arm:0x018'
ARM_SYMBOLS+=--add-symbol 'reset=.arm:0x01c'
ARM_SYMBOLS+=--add-symbol 'emulate_reset1=.arm:0x09e'
ARM_SYMBOLS+=--add-symbol 'emulate_reset2=.arm:0x0a6'
ARM_SYMBOLS+=--add-symbol '&scbcrp=.arm:0x0b0'
ARM_SYMBOLS+=--add-symbol '&boot[43c]=.arm:0x0b4'
ARM_SYMBOLS+=--add-symbol '&boot[5d0]=.arm:0x0b8'
ARM_SYMBOLS+=--add-symbol '&crp4=.arm:0x0bc'
ARM_SYMBOLS+=--add-symbol '&top_ram=.arm:0x0c0'
ARM_SYMBOLS+=--add-symbol '&reset2=.arm:0x0c4'
ARM_SYMBOLS+=--add-symbol '&usercrp=.arm:0x0c8'
ARM_SYMBOLS+=--add-symbol 'crp2=.arm:0x0cc'
ARM_SYMBOLS+=--add-symbol 'crp3=.arm:0x0d0'
ARM_SYMBOLS+=--add-symbol 'crp1=.arm:0x0d4'
ARM_SYMBOLS+=--add-symbol 'top_ram=.arm:0x0d8'
ARM_SYMBOLS+=--add-symbol 'crp4=.arm:0x0dc'
ARM_SYMBOLS+=--add-symbol 'nmi=.arm:0x0e0'
ARM_SYMBOLS+=--add-symbol 'hardfault=.arm:0x0e2'
ARM_SYMBOLS+=--add-symbol 'mmfault=.arm:0x0e4'
ARM_SYMBOLS+=--add-symbol 'busfault=.arm:0x0e6'
ARM_SYMBOLS+=--add-symbol 'usagefault=.arm:0x0e8'
ARM_SYMBOLS+=--add-symbol '$$d=.arm:0x0f0,local'
ARM_SYMBOLS+=--add-symbol '$$t=.arm:0x0f4,local'
ARM_SYMBOLS+=--add-symbol 'interpret_command=.arm:0x0f4'
ARM_SYMBOLS+=--add-symbol 'autobaud=.arm:0x1a2'
ARM_SYMBOLS+=--add-symbol 'isp_entry=.arm:0x2ec'
ARM_SYMBOLS+=--add-symbol 'pop_and_return=.arm:0x2ac'
ARM_SYMBOLS+=--add-symbol 'setup_clocks_and_peripherals=.arm:0x2b0'
ARM_SYMBOLS+=--add-symbol 'start_usercode_if_checksum_good=.arm:0x346'
ARM_SYMBOLS+=--add-symbol 'setup_emc_pins=.arm:0x388'
ARM_SYMBOLS+=--add-symbol 'setup_emc=.arm:0x3e6'
ARM_SYMBOLS+=--add-symbol 'usercode_entry=.arm:0x44c'
ARM_SYMBOLS+=--add-symbol 'reset2=.arm:0x46e'
ARM_SYMBOLS+=--add-symbol '$$d=.arm:0x4f4,local'
ARM_SYMBOLS+=--add-symbol '&crp2=.arm:0x4f4'
ARM_SYMBOLS+=--add-symbol '&isp_ram_vars=.arm:0x4f8'
ARM_SYMBOLS+=--add-symbol '&crp3=.arm:0x4fc'
ARM_SYMBOLS+=--add-symbol '&ram[1bc]=.arm:0x500'
ARM_SYMBOLS+=--add-symbol '&crp1=.arm:0x504'
ARM_SYMBOLS+=--add-symbol '&boot[430]=.arm:0x508'
ARM_SYMBOLS+=--add-symbol '&gpio=.arm:0x50C'
ARM_SYMBOLS+=--add-symbol '&timer1=.arm:0x510'
ARM_SYMBOLS+=--add-symbol '&pinconnect=.arm:0x514'
ARM_SYMBOLS+=--add-symbol '&Synchronized=.arm:0x518'
ARM_SYMBOLS+=--add-symbol '&sysctl[150]=.arm:0x51C'
ARM_SYMBOLS+=--add-symbol '&uart0=.arm:0x520'
ARM_SYMBOLS+=--add-symbol '&&usercrp=.arm:0x524'
ARM_SYMBOLS+=--add-symbol '&OK=.arm:0x528'
ARM_SYMBOLS+=--add-symbol '&boot[5b4]=.arm:0x52C'
ARM_SYMBOLS+=--add-symbol '&boot[458]=.arm:0x530'
ARM_SYMBOLS+=--add-symbol '&sysctl=.arm:0x534'
ARM_SYMBOLS+=--add-symbol '&boot[5b8]=.arm:0x538'
ARM_SYMBOLS+=--add-symbol '&boot[5f4]=.arm:0x53C'
ARM_SYMBOLS+=--add-symbol '&emc=.arm:0x540'
ARM_SYMBOLS+=--add-symbol '&boot[5d0]=.arm:0x544'
ARM_SYMBOLS+=--add-symbol 'crp4=.arm:0x548'
ARM_SYMBOLS+=--add-symbol '&adc=.arm:0x554'
ARM_SYMBOLS+=--add-symbol 'reset2_cont=.arm:0x558'
ARM_SYMBOLS+=--add-symbol '$$t=.arm:0x558,local'
ARM_SYMBOLS+=--add-symbol '$$d=.arm:0x5f4,local'
ARM_SYMBOLS+=--add-symbol '&boot[5b0]=.arm:0x5f4'
ARM_SYMBOLS+=--add-symbol '&boot[5b4]=.arm:0x5f8'
ARM_SYMBOLS+=--add-symbol '&boot[5bc]=.arm:0x5fc'
ARM_SYMBOLS+=--add-symbol '&boot[5e0]=.arm:0x600'
ARM_SYMBOLS+=--add-symbol '&boot[5e4]=.arm:0x604'
ARM_SYMBOLS+=--add-symbol '&boot[5f0]=.arm:0x608'
ARM_SYMBOLS+=--add-symbol '&boot[5e8]=.arm:0x60c'
ARM_SYMBOLS+=--add-symbol '&boot[5ec]=.arm:0x610'
ARM_SYMBOLS+=--add-symbol '&boot[5d4]=.arm:0x614'
ARM_SYMBOLS+=--add-symbol '&boot[5c8]=.arm:0x618'
ARM_SYMBOLS+=--add-symbol '&boot[5cc]=.arm:0x61C'
ARM_SYMBOLS+=--add-symbol 'bitmask=.arm:0x620'
ARM_SYMBOLS+=--add-symbol '&gpio=.arm:0x624'
ARM_SYMBOLS+=--add-symbol '&crp5=.arm:0x628'
ARM_SYMBOLS+=--add-symbol '$$t=.arm:0x62C,local'
ARM_SYMBOLS+=--add-symbol 'rounded_divide=.arm:0x782'
ARM_SYMBOLS+=--add-symbol 'set_baud=.arm:0x118c'
ARM_SYMBOLS+=--add-symbol 'write_char=.arm:0x11ca'
ARM_SYMBOLS+=--add-symbol 'read_and_echo=.arm:0x11d6'
ARM_SYMBOLS+=--add-symbol 'wait_for_ctrl_q=.arm:0x11f4'
ARM_SYMBOLS+=--add-symbol 'write_str=.arm:0x1200'
ARM_SYMBOLS+=--add-symbol 'has_read=.arm:0x1244'
ARM_SYMBOLS+=--add-symbol 'mirror_delay=.arm:0x1256'
ARM_SYMBOLS+=--add-symbol 'read_str=.arm:0x1266'
ARM_SYMBOLS+=--add-symbol 'set_echo=.arm:0x12b0'
ARM_SYMBOLS+=--add-symbol '$$d=.arm:0x12b8,local'
ARM_SYMBOLS+=--add-symbol '&uart0=.arm:0x12b8'
ARM_SYMBOLS+=--add-symbol '&echo=.arm:0x12bc'
ARM_SYMBOLS+=--add-symbol '&timer1=.arm:0x12c0'
ARM_SYMBOLS+=--add-symbol '$$t=.arm:0x12c4,local'
ARM_SYMBOLS+=--add-symbol 'strcmp=.arm:0x12c4'
ARM_SYMBOLS+=--add-symbol 'routine12e2=.arm:0x12e2'
ARM_SYMBOLS+=--add-symbol '$$d=.arm:0x1630,local'
ARM_SYMBOLS+=--add-symbol 'Synchronized=.arm:0x1630'
ARM_SYMBOLS+=--add-symbol 'OK=.arm:0x1654'
ARM_SYMBOLS+=--add-symbol '$$t=.arm:0x1684,local'
ARM_SYMBOLS+=--add-symbol 'delay=.arm:0x16da'
ARM_SYMBOLS+=--add-symbol 'lock_bootblock=.arm:0x16ee'
ARM_SYMBOLS+=--add-symbol 'unlock_bootblock=.arm:0x16fe'
ARM_SYMBOLS+=--add-symbol 'routine170e=.arm:0x170e'
ARM_SYMBOLS+=--add-symbol '$$d=.arm:0x1784,local'
ARM_SYMBOLS+=--add-symbol '$$t=.arm:0x17a0,local'
ARM_SYMBOLS+=--add-symbol '$$d=.arm:0x1c7c,local'
ARM_SYMBOLS+=--add-symbol '$$t=.arm:0x1c80,local'
ARM_SYMBOLS+=--add-symbol 'real_iap=.arm:0x17a0'
ARM_SYMBOLS+=--add-symbol 'IAP_LOCATION=.arm:0x1ff0'

bootstrap.o: bootstrap.hex Makefile
	arm-none-eabi-objcopy $< -O elf32-little -B arm --rename-section .sec1=.arm --set-section-flags .sec1=alloc,contents,load,code,rom $(ARM_SYMBOLS) $@

bootstrap.disasm: bootstrap.o Makefile notes.txt ../DumpIap/asm_note.pl
	cp $@ notes.txt
	arm-none-eabi-objdump -d -marm -z $< | perl ../DumpIap/asm_note.pl notes.txt > $@

mbed_blinky.disasm: mbed_blinky.elf Makefile notes.txt ../DumpIap/asm_note.pl
	cp $@ notes.txt
	arm-none-eabi-objdump -d -marm -z $< | perl ../DumpIap/asm_note.pl notes.txt > $@

bootstrap.trace: bootstrap.disasm
	java -classpath ../../../build/ org.kwansystems.emulator.arm.Emulator > $@
